#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "üîç –ü—Ä–æ–≤–µ—Ä—è—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ..."
files=$(git diff --name-only --cached)  # –ü–æ–ª—É—á–∞–µ–º –∏–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

# –ó–∞–ø—É—Å–∫–∞–µ–º Prettier —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–∏—Ö —Ñ–∞–π–ª–æ–≤
for file in $files; do
  if npx prettier --check "$file"; then
    echo "‚úÖ $file ‚Äî OK"
  else
    echo "‚ùå $file ‚Äî –û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è! –ò—Å–ø—Ä–∞–≤—å—Ç–µ:"
    npx prettier --write "$file"  # –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑–ª–∏—á–∏—è
    git add "$file"  # –î–æ–±–∞–≤–ª—è–µ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
    echo "üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–º–∏—Ç —Å–Ω–æ–≤–∞."
  fi
done